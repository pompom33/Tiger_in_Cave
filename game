#í”Œë ˆì´ì–´ ì´ë™ê±°ë¦¬
possible_distance = [1, 2, 3]

#í˜¸ë‘ì´ ì´ˆê¸° ìœ„ì¹˜ ì„¤ì •
def initialize_tiger(): 
    import random
    tiger_first_loc = random.randint(15, 30)
    return tiger_first_loc

# í”Œë ˆì´ì–´ ì´ë™ë°©í–¥
def user_direction_input(): 
    user_direction = input("ğŸ“¢ë™êµ´ì— ë“¤ì–´ê°€ë ¤ë©´ i, ë‚˜ì˜¤ë ¤ë©´ oë¥¼ ì…ë ¥í•˜ì„¸ìš”")
    return user_direction

#í”Œë ˆì´ì–´ ì´ë™ê±°ë¦¬
def user_distance_input(): 
    user_distance = input("ğŸ“¢ì–¼ë§ˆë‚˜ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")
    return user_distance

#í”Œë ˆì´ì–´ ì´ë™ êµ¬í˜„
def move_player(player_cur_loc, user_direction, user_distance): 
    player_old_loc = player_cur_loc
    if user_direction == "i":
        player_cur_loc += int(user_distance)
    if user_direction == "o":
        player_cur_loc -= int(user_distance)
    player_new_loc = int(player_cur_loc)
    if player_new_loc <= 0:
        player_new_loc = 0
    return player_new_loc

#í”Œë ˆì´ì–´ ì ìˆ˜ ê³„ì‚°
def add_score(score, user_direction, user_distance): 
    if user_direction == "i":
        score += int(user_distance)
    return score

#í˜¸ë‘ì´ ì´ë™ êµ¬í˜„
def move_tiger(tiger_cur_loc): 
    tiger_new_loc = tiger_cur_loc - 4
    if tiger_new_loc < 0:
        tiger_new_loc = 1
    return tiger_new_loc

#ê²Œì„ ì‹¤í–‰ í•¨ìˆ˜
def play_game():
    cave_length = 30  #cave ì„¤ì •
    cave = []
    for i in range(cave_length):
        cave.append("_")
    
    player_cur_loc = 0  #í”Œë ˆì´ì–´ ìœ„ì¹˜ ì´ˆê¸°í™”
    score = 0           #ì ìˆ˜ ì´ˆê¸°í™”
    
    initialize_tiger()  #í˜¸ë‘ì´ ìœ„ì¹˜ ì´ˆê¸°í™”
    tiger_first_loc = initialize_tiger()
    tiger_cur_loc = tiger_first_loc
    
    print(cave)         #ìµœì´ˆì˜ ë™êµ´ ì‹œê°í™”
    
    while True:
        print("player cur loc", player_cur_loc, "score", score)
        
        user_direction = user_direction_input()
        if user_direction == "q":      #ê²Œì„ì„ ì¤‘ë‹¨í•˜ë ¤ëŠ” ê²½ìš°
            print("ê²Œì„ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.")
            break
        if user_direction not in ["i", "o"]:   # ì˜ëª»ëœ ì…ë ¥ì„ í•œ ê²½ìš°
            print("i ë˜ëŠ” oë§Œ ì…ë ¥í•´ì£¼ì„¸ìš”.(ì¢…ë£Œ: q)")
            continue
        if player_cur_loc == 0 and user_direction == "o":     #ì²« ì›€ì§ì„ì„ 'out'ìœ¼ë¡œ ì…ë ¥í•œ ê²½ìš°
            print("ì²˜ìŒì—ëŠ” ë°˜ë“œì‹œ ë™êµ´ì— ë“¤ì–´ê°€ì•¼ í•©ë‹ˆë‹¤(i ì…ë ¥)")
            continue
            
        user_distance = user_distance_input()
        if user_distance == "q":      #ê²Œì„ì„ ì¤‘ë‹¨í•˜ë ¤ëŠ” ê²½ìš°
            print("ê²Œì„ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.")
            break
        if user_distance not in possible_distance:   # possible distance ì´ì™¸ì˜ ì˜ëª»ëœ ì…ë ¥ì„ í•œ ê²½ìš°
            print("1ë¶€í„° 3ê¹Œì§€ì˜ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”")
            continue
            
        else:                           # í”Œë ˆì´ì–´ ì´ë™ ì‚¬ì‹¤ ì¶œë ¥
            if user_direction == "i":
                print(f"{user_distance}ë§Œí¼ ë“¤ì–´ê°”ìŠµë‹ˆë‹¤.")
            if user_direction == "o":
                print(f"{user_distance}ë§Œí¼ ë‚˜ì™”ìŠµë‹ˆë‹¤.")

            move_player(player_cur_loc, user_direction, user_distance)
            move_tiger(tiger_cur_loc)
            player_new_loc = move_player(player_cur_loc, user_direction, user_distance)
            tiger_new_loc = move_tiger(tiger_cur_loc)
            score = add_score(score, user_direction, user_distance)
            cave[player_new_loc - 1] = "ğŸ‘©"
            cave[player_cur_loc - 1] = "_"
            
        if player_new_loc >= tiger_cur_loc: #íŒ¨ë°°í•  ê²½ìš°
            if player_new_loc == 0:
                continue
            print(f"{player_new_loc}ì—ì„œ í˜¸ë‘ì´ì—ê²Œ ì¡ì•„ë¨¹í˜”ìŠµë‹ˆë‹¤. í˜¸ë‘ì´ì˜ ìµœì´ˆ ìœ„ì¹˜ëŠ” {tiger_first_loc}ì´ì—ˆìŠµë‹ˆë‹¤.")
            cave[player_new_loc - 1] = "ğŸ±"
            print(cave)
            break
        if player_new_loc <= 0: #ìŠ¹ë¦¬í•  ê²½ìš°
            print(f"íƒˆì¶œí–ˆìŠµë‹ˆë‹¤! ì ìˆ˜ëŠ”{score}ì…ë‹ˆë‹¤. í˜¸ë‘ì´ì˜ ìµœì´ˆ ìœ„ì¹˜ëŠ” {tiger_first_loc}ì´ì—ˆìŠµë‹ˆë‹¤.")
            player_new_loc = 0
            cave[player_new_loc - 1] = "_"
            cave[player_cur_loc - 1] = "_"
            cave[tiger_new_loc - 1] = "ğŸ±"
            print(cave)
            break
            
        print(cave)                      # í”Œë ˆì´ì–´ ì´ë™í•œ ê²°ê³¼ ì‹œê°í™”
        player_cur_loc = player_new_loc  # new_locì„ cur_locìœ¼ë¡œ ì „í™˜(ë‹¤ìŒ loopì„ ìœ„í•´)
        tiger_cur_loc = tiger_new_loc